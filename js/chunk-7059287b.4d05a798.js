(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7059287b"],{"839d":function(e,t,o){"use strict";o.r(t);var n=o("a34a"),s=o.n(n),r=o("2f62"),a=o("ed08"),i=o("1157"),c=o.n(i);function l(e,t,o,n,s,r,a){try{var i=e[r](a),c=i.value}catch(l){return void o(l)}i.done?t(c):Promise.resolve(c).then(n,s)}function u(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var g,m,h={name:"Login",data:function(){return{lang:{show:"true"},icon:[],site:{name:"",logo:""},checkLoginClick:{nowTime:"",clickTime:""},showPassword:!1,loginInfo:{valid:!0,account:"",password:"",rules:[function(e){return(e||"").indexOf(" ")<0||"不能為空格"},function(e){return/^[A-Za-z0-9]+$/.test(e)||""===e||"需為英文或數字"}]},checkbox:!1,errorMsg:"",agreeRules:!0}},created:function(){sessionStorage.removeItem("super.manage.request.login")},mounted:function(){this.setViewport(!1),this.initLanguage(),this.init(),this.$axios.defaults.headers.common.Authorization&&sessionStorage.getItem("super.manage.login.status")&&"logout"===this.$route.query.status&&this.logoutActive(),this.$store.dispatch("account-management/setProfile",""),this.clearSessionStorage(),sessionStorage.removeItem("super.manage.login.type"),localStorage.clear(),this.loadSiteInfo(),this.$refs.form.resetValidation()},destroyed:function(){this.setViewport(!0)},methods:function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},n=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter((function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})))),n.forEach((function(t){u(e,t,o[t])}))}return e}({},Object(r.b)({login:"api/login",logout:"api/logout",setLanguage:"api/setLanguage"}),{init:function(){var e={vi:"vi","zh-Hant":"zh-TW","zh-Hans":"zh-CN"},t=""===this.$store.state.lang?e["zh-Hant"]:e[this.$store.state.lang];this.icon=[{name:"firefox",url:"https://www.mozilla.org/".concat(t,"/firefox/new/"),img:"".concat("/client/","img/browser/firefox-icon.png")},{name:"google",url:"https://www.google.com/intl/".concat(t,"/chrome/"),img:"".concat("/client/","img/browser/chrome-icon.png")},{name:"safri",url:"https://support.apple.com/downloads/#safari",img:"".concat("/client/","img/browser/safari-icon.png")}]},loadSiteInfo:(g=s.a.mark((function d(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.$mock.onGet("miscellaneous/siteName").reply(200,{}),this.$mock.restore(),t.next=5,this.$axios.get("miscellaneous/siteName",{});case 5:return(e=t.sent).data.result.logo&&(this.site.name=e.data.result.name,this.site.logo="".concat(document.location.protocol,"//").concat(e.data.result.logo)),t.abrupt("return",e);case 10:return t.prev=10,t.t0=t["catch"](0),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),d,this,[[0,10]])})),m=function(){var e=this,t=arguments;return new Promise((function(o,n){var s=g.apply(e,t);function r(e){l(s,o,n,r,a,"next",e)}function a(e){l(s,o,n,r,a,"throw",e)}r(undefined)}))},function(){return m.apply(this,arguments)}),loginActive:function(){var e=this;if(this.loginInfo.valid){if(!this.loginInfo.account)return this.$toastr.error(this.$ln("尚未輸入帳號")),void(this.errorMsg=this.$ln("尚未輸入帳號"));if(!this.loginInfo.password)return this.$toastr.error(this.$ln("尚未輸入密碼")),void(this.errorMsg=this.$ln("尚未輸入密碼"));if(this.agreeRules)try{if(this.checkLoginClick.nowTime=(new Date).getTime(),""!==this.checkLoginClick.clickTime&&this.checkLoginClick.nowTime-this.checkLoginClick.clickTime<500)return this.$toastr.error(this.$ln("操作過於頻繁！")),void(this.errorMsg=this.$ln("操作過於頻繁！"));if(this.checkLoginClick.clickTime=this.checkLoginClick.nowTime,sessionStorage.getItem("super.manage.request.login"))return;this.login({l_no:this.loginInfo.account,l_pwd:this.loginInfo.password}).then((function(t){"[object Error]"===Object.prototype.toString.call(t)&&t.hasOwnProperty("response")&&200!==t.response.status?t.response.data.hasOwnProperty("errors")?(a.a.errorMsgHandler(t.response.data.errors),e.errorMsg=t.response.data.errors.message):(e.$toastr.error("".concat(e.loginInfo.account," ").concat(e.$ln("登入失敗！請重新登入"))),sessionStorage.removeItem("super.manage.request.login")):200===t.status&&(sessionStorage.setItem("super.manage.request.login",!0),sessionStorage.setItem("super.manage.login.status","".concat(e.loginInfo.account," login")),e.$toastr.success("".concat(e.loginInfo.account," ").concat(e.$ln("登入成功")),"",{timeOut:2e3,closeButton:!1}),e.$router.push({path:"/manage/announcement"}))}))["catch"]((function(t){e.$toastr.error("".concat(e.loginInfo.account," ").concat(e.$ln("登入失敗"))),sessionStorage.removeItem("super.manage.request.login")}))}catch(t){this.$toastr.error(this.$ln("站台資料錯誤，請聯絡客服")),this.errorMsg=this.$ln("站台資料錯誤，請聯絡客服")}else this.$toastr.error(this.$ln("尚未勾選遵守服務規則"))}},logoutActive:function(){var e=this;try{this.logout().then((function(t){if("[object Error]"===Object.prototype.toString.call(t)&&t.hasOwnProperty("response")&&200!==t.response.status){if(400===t.response.status||401===t.response.status)return;t.response.data.hasOwnProperty("errors")?a.a.errorMsgHandler(t.response.data.errors):e.$toastr.error("".concat(e.$ln("登出失敗"),"！"))}else 200===t.status&&(e.clearSessionStorage(),t.data.hasOwnProperty("errors")||t.data.hasOwnProperty("result")&&t.data.result.hasOwnProperty("message")&&e.$toastr.success(t.data.result.message,"",{timeOut:2e3,closeButton:!1}))}))["catch"]((function(t){e.$toastr.error(e.$ln("登出失敗"))}))}catch(t){this.$toastr.error(this.$ln("站台資料錯誤，請聯絡客服")),this.errorMsg=this.$ln("站台資料錯誤，請聯絡客服")}},setViewport:function(e){var t=c()("#viewport").prop("content").split(","),o=[];e?(t.forEach((function(e,t){"maximum-scale=1.0"!==e&&"user-scalable=0"!==e&&o.push(e)})),c()("#viewport").prop("content",o.join(","))):(t.push("maximum-scale=1.0"),t.push("user-scalable=0"),c()("#viewport").prop("content",t.join(",")))},clearSessionStorage:function(){sessionStorage.removeItem("super.manage.login.status"),sessionStorage.removeItem("super.manage.name"),sessionStorage.removeItem("super.manage.account"),sessionStorage.removeItem("super.manage.ws"),sessionStorage.removeItem("super.manage.level"),sessionStorage.removeItem("super.manage.subLevel"),sessionStorage.removeItem("super.manage.dashboard.info"),sessionStorage.removeItem("super.manage.dashboard.info.unit"),sessionStorage.removeItem("super.manage.dashboard.info.unit2"),sessionStorage.removeItem("report.search.level"),sessionStorage.removeItem("report.search.account")},initLanguage:function(){this.site.name=this.$ln("登入資訊")}})},p=(o("a017"),o("2877")),f=Object(p.a)(h,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login"},[o("v-container",{staticClass:"pt-5",attrs:{fluid:""}},[o("div",{staticClass:"dragonBoat"},[o("img",{attrs:{src:"/client/css/themes/dragonBoat/txt.png"}})]),o("v-layout",{attrs:{row:"","fill-height":""}},[o("v-flex",{attrs:{xs12:"",md4:"","offset-md4":""}},[o("div",{staticClass:"loginBox"},[o("material-card",[o("div",{staticClass:"py-1 text-xs-center"},[o("div",{staticClass:"logo"},[e.site.logo?o("img",{attrs:{src:e.site.logo,alt:e.$ln("管理端")}}):e._e()])]),o("v-card-text",["true"===e.lang.show?o("SelectSelectLanguage",{attrs:{showLabel:!1,showIcon:!1,showText:!0,styleName:"Vuetify"}}):e._e(),o("v-form",{ref:"form",model:{value:e.loginInfo.valid,callback:function(t){e.$set(e.loginInfo,"valid",t)},expression:"loginInfo.valid"}},[o("v-text-field",{attrs:{label:e.$ln("請輸入您的管理帳號"),placeholder:e.$ln("帳號"),color:"amber darken-3"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.loginActive()}},model:{value:e.loginInfo.account,callback:function(t){e.$set(e.loginInfo,"account",t)},expression:"loginInfo.account"}}),o("v-text-field",{attrs:{"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password",label:e.$ln("請輸入您的管理密碼"),placeholder:e.$ln("密碼"),color:"amber darken-3"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.loginActive()},"click:append":function(){return e.showPassword=!e.showPassword}},model:{value:e.loginInfo.password,callback:function(t){e.$set(e.loginInfo,"password",t)},expression:"loginInfo.password"}}),o("div",{staticStyle:{"min-height":"34px"}},[o("div",{staticClass:"red--text caption"},[e._v(e._s(e.errorMsg))])]),o("v-btn",{attrs:{small:"",block:"",color:"green darken-3",disabled:!e.loginInfo.valid},on:{click:function(t){e.loginActive()}}},[e._v("\n                  "+e._s(e.$ln("登入"))+"\n                ")]),o("v-checkbox",{attrs:{label:e.$ln("我同意遵守服務規則"),rules:[function(t){return!!t||e.$ln("尚未勾選遵守服務規則")}],required:""},model:{value:e.agreeRules,callback:function(t){e.agreeRules=t},expression:"agreeRules"}}),o("v-flex",{attrs:{xs12:"",sm8:"",md8:"","mb-2":""}},[o("small",[e._v(e._s(e.$ln("建議使用瀏覽器(點擊下載)")))])]),o("v-layout",{attrs:{warp:"",row:""}},e._l(e.icon,(function(e,t){return o("v-flex",{key:t,attrs:{xs2:"",sm1:"",md1:"","mr-1":""}},[o("a",{attrs:{href:e.url,target:"_blank"}},[o("v-img",{attrs:{src:e.img,"max-width":"33","max-height":"33"}})],1)])})),1)],1)],1)],1)],1)])],1)],1)],1)}),[],!1,null,"4a97d63c",null);f.options.__file="Login.vue";t["default"]=f.exports},a017:function(e,t,o){"use strict";var n=o("c8a9");o.n(n).a},c8a9:function(e,t,o){}}]);
//# sourceMappingURL=chunk-7059287b.4d05a798.js.map